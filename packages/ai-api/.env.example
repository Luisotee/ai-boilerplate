DATABASE_URL=postgresql://aiagent:changeme@localhost:5432/aiagent
GEMINI_API_KEY=your_gemini_api_key_here
LOG_LEVEL=INFO

# Redis Configuration (for arq queue)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# arq Worker Configuration
ARQ_MAX_JOBS=50
ARQ_JOB_TIMEOUT=120
ARQ_POLL_DELAY=0.1
ARQ_KEEP_RESULT=3600

# Queue Behavior
QUEUE_PER_USER_MAX_JOBS=1
QUEUE_CHUNK_TTL=3600

# Message History Limits (recent window)
# Private conversations: total messages (including user and assistant)
HISTORY_LIMIT_PRIVATE=20
# Group conversations: total messages (all participants and assistant)
HISTORY_LIMIT_GROUP=30

# Semantic Search Configuration (RAG - requires GEMINI_API_KEY)
# Maximum number of semantically similar messages to retrieve
SEMANTIC_SEARCH_LIMIT=5
# Cosine similarity threshold (0-1, higher = more similar)
SEMANTIC_SIMILARITY_THRESHOLD=0.7
# Context window for semantic search results
# Number of messages to include before and after each match
SEMANTIC_CONTEXT_WINDOW=3

# Token Management
# Maximum tokens for entire context (includes recent window + semantic results)
MAX_CONTEXT_TOKENS=50000
# Always preserve this many recent messages
MIN_RECENT_MESSAGES=5

# Knowledge Base Configuration (PDF RAG - requires GEMINI_API_KEY)
# Directory for storing uploaded PDF files
KB_UPLOAD_DIR=/tmp/knowledge_base
# Maximum file size for uploads (in MB)
KB_MAX_FILE_SIZE_MB=50
# Maximum total batch size for batch uploads (in MB)
KB_MAX_BATCH_SIZE_MB=500
# Maximum number of document chunks to retrieve per search
KB_SEARCH_LIMIT=5
# Cosine similarity threshold for document search (0-1, higher = more similar)
KB_SIMILARITY_THRESHOLD=0.7

# HybridChunker Configuration (token-aware, structure-aware chunking for RAG)
# Maximum tokens per chunk - aligns with Gemini embedding model
# Gemini embedding-001 supports up to 2048 tokens, but 512 provides better retrieval granularity
# Smaller (256-384): More precise retrieval, more chunks, higher storage
# Larger (768-1024): More context per chunk, fewer chunks, less precise retrieval
KB_MAX_CHUNK_TOKENS=512
